# D&D Master CLI

Простое CLI приложение для игры в D&D с AI мастером, использующее OpenAI API.

## Установка

1. Убедитесь, что у вас установлен Python 3.7+
2. Установите зависимости:
```bash
pip install -r requirements.txt
```

3. Создайте файл `.env` в корне проекта и добавьте ваш OpenAI API ключ:
```
OPENAI_API_KEY=your_openai_api_key_here
```

## Запуск

### GUI версия (рекомендуется):
```bash
python dnd_master_gui.py
```

### CLI версия:
```bash
python dnd_master.py
```

## Использование

### GUI версия:
1. Запустите приложение - откроется окно с интерфейсом
2. В верхней части отображается история чата с прокруткой
3. В нижней части введите ваши действия или вопросы как игрок
4. Нажмите "Отправить" или Ctrl+Enter для отправки сообщения
5. AI мастер будет отвечать и вести игру
6. Нажмите "Выход" для закрытия приложения

### CLI версия:
1. Запустите приложение
2. Введите ваши действия или вопросы как игрок
3. AI мастер будет отвечать и вести игру
4. Для выхода введите `quit`, `exit` или `выход`

## Примеры использования

- "Я атакую гоблина мечом"
- "Что я вижу в этой комнате?"
- "Проверяю на восприятие"
- "Хочу поговорить с торговцем"
- "Бросаю кубик на атаку"

## Библия мира

При первом запуске приложение автоматически генерирует уникальную "Библию мира" - файл `world_bible.md`, который содержит:

- **Сеттинг** - уникальный мир с определенной атмосферой
- **Тон и стиль** - настроение кампании и жанровые правила  
- **Великие табу** - что категорически нельзя делать в этом мире
- **Стартовая локация** - место начала приключений с NPC и достопримечательностями
- **Ключевые фракции** - основные силы мира с их целями и отношениями
- **Мировые константы** - 7 фундаментальных правил, которые никогда не нарушаются

Библия мира генерируется один раз и сохраняется для последующих сессий. AI мастер строго следует правилам и константам мира, обеспечивая последовательность игры.

### Просмотр Библии мира:
- **GUI версия**: Нажмите кнопку "Мир"
- **CLI версия**: Введите команду `мир`, `bible` или `библия`

## Система бросков костей

Приложение автоматически определяет, когда нужны броски костей, и выполняет их за кадром:

### Автоматические броски:
- **Атака** - d20 + бонус атаки
- **Урон** - зависит от оружия (обычно d8 для меча)
- **Проверки навыков** - d20 + модификатор характеристики
- **Спасброски** - d20 + модификатор характеристики
- **Инициатива** - d20 + модификатор ловкости
- **Скрытность, Восприятие, Магия** и другие навыки

### Ручные броски:
- **GUI версия**: Нажмите кнопку "Кости" для открытия окна бросков
- **CLI версия**: Используйте команды типа "бросаю d20", "кидаю 2d6+3"

### Поддерживаемые форматы:
- `d20` - одна кость d20
- `2d6+3` - две кости d6 плюс 3
- `d100` - процентная кость
- `3d8-1` - три кости d8 минус 1

### Особенности:
- Критические удары на 20, критические промахи на 1
- Детальные результаты с показом отдельных бросков
- Интеграция с основным чатом игры

## Особенности

- **GUI интерфейс** с удобным окном чата
- **Библия мира** - автоматически генерируется уникальный игровой мир при первом запуске
- **Система бросков костей** - автоматические броски за кадром с детальными результатами
- **Правила игры** - настраиваемые механики в файле rules.yaml
- **История разговора** с прокруткой для просмотра всей игры
- **Многопоточность** - интерфейс не зависает во время обработки запросов
- **Горячие клавиши** - Ctrl+Enter для быстрой отправки сообщений
- **Сохранение контекста** - AI помнит предыдущие действия и следует правилам мира
- **Русскоязычные ответы** от AI мастера
- **Красивый дизайн** с темной темой и эмодзи
- **Простой и интуитивный интерфейс**

## Требования

- Python 3.7+
- OpenAI API ключ
- Интернет соединение

